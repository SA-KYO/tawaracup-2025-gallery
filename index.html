<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¤šå’Œæ¥½æ¯2025 ã‚®ãƒ£ãƒ©ãƒªãƒ¼</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ãƒ•ã‚©ãƒ³ãƒˆ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Noto Sans JP', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: radial-gradient(circle at top, #fff7ff 0, #f3e8ff 30%, #f9fafb 70%);
    }
    .title-font {
      font-family: 'Poppins', 'Noto Sans JP', system-ui, sans-serif;
      letter-spacing: 0.08em;
    }
    .fade-in {
      animation: fade-in 0.4s ease-out;
    }
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="min-h-screen px-4 py-6">
  <div class="max-w-5xl mx-auto">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="flex items-center justify-between mb-4">
      <div>
        <h1 class="title-font text-xl md:text-2xl font-bold text-purple-700">
          å¤šå’Œæ¥½æ¯2025 ã‚®ãƒ£ãƒ©ãƒªãƒ¼
        </h1>
        <p class="text-xs md:text-sm text-gray-600 mt-1">
          ã‚³ãƒ³ãƒšå½“æ—¥ã«ã¿ã‚“ãªãŒã‚¢ãƒƒãƒ—ã—ã¦ãã‚ŒãŸå†™çœŸãƒ»å‹•ç”»ãŒã€è‡ªå‹•ã§ã“ã“ã«ä¸¦ã³ã¾ã™ã€‚
        </p>
      </div>
      <a
        href="https://tawaracup-2025-photo.netlify.app/"
        class="text-xs md:text-sm text-purple-700 border border-purple-300 rounded-full px-3 py-1 hover:bg-purple-50 transition"
      >
        â† ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»é¢ã«æˆ»ã‚‹
      </a>
    </header>

    <!-- ä¿å­˜æ–¹æ³•ã®æ¡ˆå†… -->
    <div class="mb-4 bg-white/80 border border-purple-100 rounded-2xl px-4 py-3 shadow-sm flex items-start gap-2 text-xs md:text-sm text-gray-600">
      <span class="mt-0.5 text-green-500">âœ…</span>
      <div>
        <div class="font-semibold text-purple-700 mb-0.5">å†™çœŸãƒ»å‹•ç”»ã®ä¿å­˜æ–¹æ³•</div>
        <p>
          ã‚¹ãƒãƒ›ï¼šä¿å­˜ã—ãŸã„å†™çœŸã‚„å‹•ç”»ã‚’<strong>ã‚¿ãƒƒãƒ— â†’ ç”»é¢ãŒé–‹ã„ãŸçŠ¶æ…‹ã§é•·æŠ¼ã—</strong>ã—ã€ã€Œå†™çœŸã«è¿½åŠ ã€ã€Œãƒ“ãƒ‡ã‚ªã‚’ä¿å­˜ã€ãªã©ã‚’é¸æŠ<br>
          PCï¼šã‚µãƒ ãƒã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ç”»åƒ/å‹•ç”»ãŒé–‹ã„ãŸã‚‰å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€
        </p>
      </div>
    </div>

    <!-- ã‚¿ãƒ– -->
    <div class="mb-4 flex gap-2">
      <button
        id="tab-images"
        class="flex-1 text-sm md:text-base rounded-full px-4 py-2 font-medium bg-purple-600 text-white shadow-md hover:bg-purple-700 transition"
        data-type="image"
      >
        ğŸ“· å†™çœŸ
      </button>
      <button
        id="tab-videos"
        class="flex-1 text-sm md:text-base rounded-full px-4 py-2 font-medium bg-white text-purple-700 border border-purple-200 hover:bg-purple-50 transition"
        data-type="video"
      >
        ğŸ¥ å‹•ç”»
      </button>
    </div>

    <!-- ã‚°ãƒªãƒƒãƒ‰æœ¬ä½“ -->
    <section id="gallery-section" class="bg-white/80 rounded-3xl shadow-lg p-3 md:p-4 min-h-[200px]">
      <div id="loading" class="text-center text-gray-500 text-sm py-10">
        èª­ã¿è¾¼ã¿ä¸­ã§ã™â€¦
      </div>

      <div id="empty" class="hidden text-center text-gray-400 text-sm py-10">
        ã¾ã ã“ã®ã‚¿ãƒ–ã«ã¯ãƒ¡ãƒ‡ã‚£ã‚¢ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
      </div>

      <div
        id="grid"
        class="hidden grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 fade-in"
      >
        <!-- ã“ã“ã« JS ã§ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ  -->
      </div>
    </section>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="mt-6 text-center text-[11px] text-gray-400">
      Â© 2025 å¤šå’Œæ¥½æ¯ã‚³ãƒ³ãƒšå®Ÿè¡Œå§”å“¡ä¼š
    </footer>
  </div>

  <script>
    const CLOUD_NAME = "dpef3dzrk";
    const TAG = "tawarahai2025";

    const tabImages = document.getElementById("tab-images");
    const tabVideos = document.getElementById("tab-videos");
    const loadingEl = document.getElementById("loading");
    const emptyEl = document.getElementById("empty");
    const gridEl = document.getElementById("grid");

    let cache = {
      image: null,
      video: null,
    };

    function setActiveTab(type) {
      const activeClasses = "bg-purple-600 text-white shadow-md border-transparent";
      const inactiveClasses = "bg-white text-purple-700 border border-purple-200 shadow-none";

      if (type === "image") {
        tabImages.className = tabImages.className
          .replace(inactiveClasses, "")
          .replace("  ", " ")
          .trim();
        tabVideos.className = tabVideos.className
          .replace(activeClasses, "")
          .replace("  ", " ")
          .trim();

        tabImages.classList.add(...activeClasses.split(" "));
        tabVideos.classList.add(...inactiveClasses.split(" "));
      } else {
        tabVideos.className = tabVideos.className
          .replace(inactiveClasses, "")
          .replace("  ", " ")
          .trim();
        tabImages.className = tabImages.className
          .replace(activeClasses, "")
          .replace("  ", " ")
          .trim();

        tabVideos.classList.add(...activeClasses.split(" "));
        tabImages.classList.add(...inactiveClasses.split(" "));
      }
    }

    function createImageCard(resource) {
      const publicId = resource.public_id;
      const format = resource.format;
      const secureUrl = resource.secure_url;

      // ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆæ­£æ–¹å½¢ãƒ»è»½é‡ï¼‰
      const thumbUrl =
        "https://res.cloudinary.com/" +
        CLOUD_NAME +
        "/image/upload/c_fill,w_800,h_800,q_auto,f_auto/" +
        publicId +
        "." +
        format;

      const fileName = publicId.split("/").pop();

      const card = document.createElement("div");
      card.className = "relative group overflow-hidden rounded-2xl bg-gray-50 shadow-sm hover:shadow-md transition";

      card.innerHTML = `
        <a href="${secureUrl}" target="_blank" rel="noopener noreferrer" class="block">
          <img
            src="${thumbUrl}"
            alt="${fileName}"
            class="w-full h-40 md:h-44 object-cover transition-transform duration-300 group-hover:scale-105"
          />
        </a>
        <div class="absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/60 to-transparent text-[10px] text-white px-2 py-1 flex items-center justify-between gap-1 opacity-0 group-hover:opacity-100 transition">
          <span class="truncate">ğŸ“· ${fileName}</span>
          <a
            href="${secureUrl}"
            download="${fileName}"
            class="px-2 py-0.5 rounded-full bg-white/80 text-[10px] text-purple-700 font-semibold hover:bg-white"
          >
            â†“ ä¿å­˜
          </a>
        </div>
      `;
      return card;
    }

    function createVideoCard(resource) {
      const publicId = resource.public_id;
      const format = resource.format;
      const secureUrl = resource.secure_url;
      const fileName = publicId.split("/").pop();

      // ãƒã‚¹ã‚¿ãƒ¼ç”¨ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆå…ˆé ­1ç§’ã‚’åˆ‡ã‚Šå‡ºã—ï¼‰
      const posterUrl =
        "https://res.cloudinary.com/" +
        CLOUD_NAME +
        "/video/upload/so_0,du_1,c_fill,w_800,h_800,q_auto,f_auto/" +
        publicId +
        "." +
        format;

      const card = document.createElement("div");
      card.className = "relative group overflow-hidden rounded-2xl bg-gray-50 shadow-sm hover:shadow-md transition";

      card.innerHTML = `
        <a href="${secureUrl}" target="_blank" rel="noopener noreferrer" class="block">
          <video
            src="${secureUrl}"
            poster="${posterUrl}"
            class="w-full h-40 md:h-44 object-cover"
            playsinline
            controls
          ></video>
        </a>
        <div class="absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/60 to-transparent text-[10px] text-white px-2 py-1 flex items-center justify-between gap-1 opacity-0 group-hover:opacity-100 transition">
          <span class="truncate">ğŸ¥ ${fileName}</span>
          <a
            href="${secureUrl}"
            download="${fileName}"
            class="px-2 py-0.5 rounded-full bg-white/80 text-[10px] text-purple-700 font-semibold hover:bg-white"
          >
            â†“ ä¿å­˜
          </a>
        </div>
      `;
      return card;
    }

    async function loadMedia(type) {
      setActiveTab(type);
      loadingEl.classList.remove("hidden");
      emptyEl.classList.add("hidden");
      gridEl.classList.add("hidden");
      gridEl.innerHTML = "";

      try {
        // ã™ã§ã«å–å¾—æ¸ˆã¿ãªã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰
        let resources = cache[type];
        if (!resources) {
          const url = `https://res.cloudinary.com/${CLOUD_NAME}/${type}/list/${TAG}.json`;
          const res = await fetch(url);
          if (!res.ok) {
            throw new Error("failed to fetch");
          }
          const data = await res.json();
          resources = data.resources || [];
          cache[type] = resources;
        }

        loadingEl.classList.add("hidden");

        if (!resources.length) {
          emptyEl.classList.remove("hidden");
          gridEl.classList.add("hidden");
          return;
        }

        // ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹
        resources.forEach((r) => {
          const card = type === "image" ? createImageCard(r) : createVideoCard(r);
          gridEl.appendChild(card);
        });

        emptyEl.classList.add("hidden");
        gridEl.classList.remove("hidden");
      } catch (e) {
        console.error(e);
        loadingEl.textContent = "èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚";
      }
    }

    // ã‚¿ãƒ–ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    tabImages.addEventListener("click", () => loadMedia("image"));
    tabVideos.addEventListener("click", () => loadMedia("video"));

    // åˆæœŸè¡¨ç¤ºã¯ã€Œå†™çœŸã€ã‚¿ãƒ–
    loadMedia("image");
  </script>
</body>
</html>
