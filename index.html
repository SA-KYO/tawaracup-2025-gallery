<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¤šå’Œæ¥½æ¯2025 å†™çœŸãƒ»å‹•ç”»ã‚®ãƒ£ãƒ©ãƒªãƒ¼</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ãƒ•ã‚©ãƒ³ãƒˆ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Noto Sans JP', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .title-font {
      font-family: 'Poppins', 'Noto Sans JP', system-ui, sans-serif;
      letter-spacing: 0.08em;
    }
    /* ã€Œå¤šå’Œæ¥½æ¯2025 ã‚³ãƒ³ãƒšã€ãƒãƒƒã‚¸ã®ã‚­ãƒ©ãƒƒâœ¨ã‚¢ãƒ‹ãƒ¡ */
    .tw-badge {
      position: relative;
      overflow: hidden;
    }
    .tw-badge::after {
      content: "";
      position: absolute;
      top: -50%;
      left: -30%;
      width: 40%;
      height: 200%;
      background: linear-gradient(
        120deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.8) 50%,
        rgba(255, 255, 255, 0) 100%
      );
      transform: translateX(-120%) rotate(15deg);
      animation: tw-shine 1.6s linear infinite;
    }
    @keyframes tw-shine {
      0%   { transform: translateX(-120%) rotate(15deg); }
      70%  { transform: translateX(180%) rotate(15deg); }
      100% { transform: translateX(180%) rotate(15deg); }
    }
  </style>
</head>
<body class="bg-gradient-to-b from-emerald-50 via-emerald-50/80 to-emerald-100 min-h-screen">

  <main class="max-w-5xl mx-auto px-4 py-6 md:py-10">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="mb-6 md:mb-8">
      <div class="inline-flex tw-badge items-center gap-2 px-4 py-1 rounded-full bg-emerald-600 text-emerald-50 shadow-md mb-3">
        <span class="text-lg">ğŸŒï¸â€â™‚ï¸</span>
        <span class="text-xs md:text-sm font-semibold tracking-wide">å¤šå’Œæ¥½æ¯2025 ã‚³ãƒ³ãƒš</span>
      </div>
      <h1 class="title-font text-2xl md:text-3xl lg:text-4xl font-bold text-emerald-900 mb-2">
        å†™çœŸãƒ»å‹•ç”»ã‚®ãƒ£ãƒ©ãƒªãƒ¼
      </h1>
      <p class="text-sm md:text-base text-emerald-900/80 leading-relaxed">
        ã‚³ãƒ³ãƒšå½“æ—¥ã«ã¿ã‚“ãªãŒã‚¢ãƒƒãƒ—ã—ã¦ãã‚ŒãŸãƒ™ã‚¹ãƒˆã‚·ãƒ§ãƒƒãƒˆãŒä¸¦ã³ã¾ã™ã€‚
      </p>
    </header>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ ï¼‹ ã‚¿ãƒ–ï¼‹èª¬æ˜ -->
    <section class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-lg border border-emerald-100 p-4 md:p-6 mb-6 md:mb-8">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
        <a
          href="https://tawaracup-2025-photo.netlify.app/"
          class="inline-flex items-center justify-center px-4 py-2 rounded-full border border-emerald-300 text-emerald-800 text-xs md:text-sm font-semibold hover:bg-emerald-50 transition"
        >
          â† ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»é¢ã«æˆ»ã‚‹
        </a>

        <!-- å†™çœŸ / å‹•ç”» ã‚¿ãƒ– -->
        <div class="flex bg-emerald-50 rounded-full p-1 w-full md:w-auto">
          <button
            id="tabPhotos"
            class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 text-xs md:text-sm font-semibold rounded-full bg-emerald-600 text-white shadow-sm transition"
          >
            <span>ğŸ“¸</span><span>å†™çœŸ</span>
          </button>
          <button
            id="tabVideos"
            class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 text-xs md:text-sm font-semibold rounded-full text-emerald-700 hover:bg-emerald-100 transition"
          >
            <span>ğŸ¬</span><span>å‹•ç”»</span>
          </button>
        </div>
      </div>

      <!-- èª¬æ˜æ–‡ -->
      <div id="hintPhotos" class="text-xs md:text-sm text-emerald-900/80 leading-relaxed space-y-1">
        <p>
          ã‚¹ãƒãƒ›ï¼šã‚µãƒ ãƒã‚¤ãƒ« ã¾ãŸã¯ã€Œâ†“ é–‹ã„ã¦ä¿å­˜ã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨å†™çœŸãŒåˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã™ã€‚
          ãã“ã§ã‚‚ã†ä¸€åº¦ã‚¿ãƒƒãƒ—ã—ã¦å…¨ç”»é¢ã«ã—ãŸå¾Œã€é•·æŠ¼ã—ã—ã¦ã€Œå†™çœŸã«ä¿å­˜ã€ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
        </p>
      </div>
      <div id="hintVideos" class="hidden text-xs md:text-sm text-emerald-900/80 leading-relaxed space-y-1">
        <p>
          ã‚¹ãƒãƒ›ï¼šã‚µãƒ ãƒã‚¤ãƒ« ã¾ãŸã¯ã€Œâ†“ é–‹ã„ã¦ä¿å­˜ã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”»é¢ãŒåˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã™ã€‚
          ç”»é¢å³ä¸Šã®å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã€ã‚„ã€Œãƒ“ãƒ‡ã‚ªã‚’ä¿å­˜ã€ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
        </p>
        <p class="text-[11px] md:text-xs text-emerald-900/70">
          â€»ãƒ–ãƒ©ã‚¦ã‚¶ã‚„ç«¯æœ«ã«ã‚ˆã‚Šè¡¨ç¤ºãŒå°‘ã—ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
        </p>
      </div>
    </section>

    <!-- å†™çœŸä¸€è¦§ -->
    <section id="photosSection" class="mb-10">
      <h2 class="flex items-center gap-2 text-lg md:text-xl font-bold text-emerald-900 mb-2">
        <span>ğŸ“·</span><span>å†™çœŸä¸€è¦§</span>
      </h2>
      <p class="text-xs md:text-sm text-emerald-900/80 mb-3">
        æ°—ã«å…¥ã£ãŸå†™çœŸã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨åˆ¥ã‚¿ãƒ–ã§å¤§ããè¡¨ç¤ºã§ãã¾ã™ã€‚
        ã€Œâ†“ é–‹ã„ã¦ä¿å­˜ã€ã‹ã‚‰åŒã˜ç”»é¢ã‚’é–‹ãã“ã¨ã‚‚ã§ãã¾ã™ã€‚
      </p>

      <div id="photosLoading" class="flex items-center gap-2 text-sm text-emerald-700 mb-3">
        <span class="inline-block w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"></span>
        <span>å†™çœŸã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™â€¦</span>
      </div>
      <p id="photosEmpty" class="hidden text-sm text-emerald-800 mb-3">
        ã¾ã å†™çœŸãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
      </p>
      <p id="photosError" class="hidden text-sm text-red-500 mb-3">
        å†™çœŸã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
      </p>

      <!-- å†™çœŸã‚°ãƒªãƒƒãƒ‰ -->
      <div
        id="photosGrid"
        class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-5"
      ></div>
    </section>

    <!-- å‹•ç”»ä¸€è¦§ -->
    <section id="videosSection" class="hidden mb-10">
      <h2 class="flex items-center gap-2 text-lg md:text-xl font-bold text-emerald-900 mb-2">
        <span>ğŸ¥</span><span>å‹•ç”»ä¸€è¦§</span>
      </h2>
      <p class="text-xs md:text-sm text-emerald-900/80 mb-3">
        å¥½ããªå‹•ç”»ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨åˆ¥ã‚¿ãƒ–ã§å†ç”Ÿã§ãã¾ã™ã€‚
        ã€Œâ†“ é–‹ã„ã¦ä¿å­˜ã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”»é¢ãŒé–‹ãã€å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ä¿å­˜ã§ãã¾ã™ã€‚
      </p>

      <div id="videosLoading" class="flex items-center gap-2 text-sm text-emerald-700 mb-3">
        <span class="inline-block w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"></span>
        <span>å‹•ç”»ã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™â€¦</span>
      </div>
      <p id="videosEmpty" class="hidden text-sm text-emerald-800 mb-3">
        ã¾ã å‹•ç”»ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
      </p>
      <p id="videosError" class="hidden text-sm text-red-500 mb-3">
        å‹•ç”»ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
      </p>

      <!-- å‹•ç”»ã‚‚å†™çœŸã¨åŒã˜ã‚°ãƒªãƒƒãƒ‰ -->
      <div
        id="videosGrid"
        class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-5"
      ></div>
    </section>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="pt-4 border-t border-emerald-200/70 mt-8">
      <p class="text-center text-xs md:text-sm text-emerald-900/70">
        Â© 2025 å¤šå’Œæ¥½æ¯ã‚³ãƒ³ãƒšå®Ÿè¡Œå§”å“¡ä¼š
      </p>
    </footer>
  </main>

  <script>
    // ====== Cloudinary è¨­å®š ======
    const CLOUD_NAME = "dpef3dzrk";
    const TAG_NAME   = "tawarahai2025";

    // ====== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ ======
    const tabPhotos      = document.getElementById("tabPhotos");
    const tabVideos      = document.getElementById("tabVideos");
    const photosSection  = document.getElementById("photosSection");
    const videosSection  = document.getElementById("videosSection");
    const hintPhotos     = document.getElementById("hintPhotos");
    const hintVideos     = document.getElementById("hintVideos");

    let videosLoaded = false;

    tabPhotos.addEventListener("click", () => {
      tabPhotos.classList.add("bg-emerald-600","text-white","shadow-sm");
      tabPhotos.classList.remove("text-emerald-700","hover:bg-emerald-100");

      tabVideos.classList.remove("bg-emerald-600","text-white","shadow-sm");
      tabVideos.classList.add("text-emerald-700","hover:bg-emerald-100");

      photosSection.classList.remove("hidden");
      videosSection.classList.add("hidden");
      hintPhotos.classList.remove("hidden");
      hintVideos.classList.add("hidden");
    });

    tabVideos.addEventListener("click", () => {
      tabVideos.classList.add("bg-emerald-600","text-white","shadow-sm");
      tabVideos.classList.remove("text-emerald-700","hover:bg-emerald-100");

      tabPhotos.classList.remove("bg-emerald-600","text-white","shadow-sm");
      tabPhotos.classList.add("text-emerald-700","hover:bg-emerald-100");

      photosSection.classList.add("hidden");
      videosSection.classList.remove("hidden");
      hintPhotos.classList.add("hidden");
      hintVideos.classList.remove("hidden");

      if (!videosLoaded) {
        loadVideos();
        videosLoaded = true;
      }
    });

    // ====== å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ======
    const safeDecode = (value) => {
      if (!value) return "";
      try {
        return decodeURIComponent(value);
      } catch {
        return value;
      }
    };

    const buildImageUrl = (publicId, format, isThumb = false) => {
      const base = `https://res.cloudinary.com/${CLOUD_NAME}/image/upload/`;
      const transform = isThumb ? "c_fill,w_900,h_900,q_auto,f_auto/" : "";
      return `${base}${transform}${publicId}.${format}`;
    };

    const buildVideoUrl = (publicId, format) => {
      const base = `https://res.cloudinary.com/${CLOUD_NAME}/video/upload/`;
      return `${base}${publicId}.${format}`;
    };

    // ====== å†™çœŸãƒ­ãƒ¼ãƒ‰ ======
    const photosGrid    = document.getElementById("photosGrid");
    const photosLoading = document.getElementById("photosLoading");
    const photosEmpty   = document.getElementById("photosEmpty");
    const photosError   = document.getElementById("photosError");

    async function loadPhotos() {
      try {
        const res = await fetch(
          `https://res.cloudinary.com/${CLOUD_NAME}/image/list/${TAG_NAME}.json`
        );
        if (!res.ok) throw new Error("image list error");
        const data = await res.json();
        const resources = data.resources || [];

        photosLoading.classList.add("hidden");

        if (resources.length === 0) {
          photosEmpty.classList.remove("hidden");
          return;
        }

        resources.forEach((item) => {
          const nameRaw    = item.context?.custom?.caption || "";
          const commentRaw = item.context?.custom?.alt || "";
          const name       = safeDecode(nameRaw);
          const comment    = safeDecode(commentRaw);

          const thumbUrl    = buildImageUrl(item.public_id, item.format, true);
          const originalUrl = buildImageUrl(item.public_id, item.format, false);

          const card = document.createElement("article");
          card.className =
            "bg-white rounded-2xl shadow-sm border border-emerald-100 flex flex-col overflow-hidden";

          const thumbBtn = document.createElement("button");
          thumbBtn.type = "button";
          thumbBtn.className =
            "relative aspect-[3/4] w-full overflow-hidden bg-emerald-50 hover:opacity-90 transition";
          thumbBtn.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          const img = document.createElement("img");
          img.src = thumbUrl;
          img.alt = comment || name || "ã‚³ãƒ³ãƒšå†™çœŸ";
          img.className = "w-full h-full object-cover";
          thumbBtn.appendChild(img);

          const body = document.createElement("div");
          body.className = "flex-1 px-3 pt-2 pb-3 flex flex-col";

          const nameEl = document.createElement("p");
          nameEl.className = "text-xs font-semibold text-emerald-900 truncate";
          nameEl.textContent = name || "åç„¡ã—ã®ã‚´ãƒ«ãƒ•ã‚¡ãƒ¼";

          const commentEl = document.createElement("p");
          commentEl.className =
            "mt-0.5 text-[11px] text-emerald-900/80 line-clamp-2 min-h-[2em]";
          commentEl.textContent = comment || "";

          const bottom = document.createElement("div");
          bottom.className = "mt-2 pt-2 border-t border-emerald-100";

          const openBtn = document.createElement("button");
          openBtn.type = "button";
          openBtn.className =
            "w-full inline-flex items-center justify-center gap-1 rounded-full bg-emerald-50 text-emerald-800 text-xs font-semibold py-1.5 hover:bg-emerald-100 transition";
          openBtn.innerHTML = "â†“ <span>é–‹ã„ã¦ä¿å­˜</span>";
          openBtn.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          bottom.appendChild(openBtn);
          body.appendChild(nameEl);
          body.appendChild(commentEl);
          body.appendChild(bottom);

          card.appendChild(thumbBtn);
          card.appendChild(body);

          photosGrid.appendChild(card);
        });
      } catch (err) {
        console.error(err);
        photosLoading.classList.add("hidden");
        photosError.classList.remove("hidden");
      }
    }

    // ====== å‹•ç”»ãƒ­ãƒ¼ãƒ‰ ======
    const videosGrid    = document.getElementById("videosGrid");
    const videosLoading = document.getElementById("videosLoading");
    const videosEmpty   = document.getElementById("videosEmpty");
    const videosError   = document.getElementById("videosError");

    async function loadVideos() {
      try {
        const res = await fetch(
          `https://res.cloudinary.com/${CLOUD_NAME}/video/list/${TAG_NAME}.json`
        );
        if (!res.ok) throw new Error("video list error");
        const data = await res.json();
        const resources = data.resources || [];

        videosLoading.classList.add("hidden");

        if (resources.length === 0) {
          videosEmpty.classList.remove("hidden");
          return;
        }

        resources.forEach((item) => {
          const nameRaw    = item.context?.custom?.caption || "";
          const commentRaw = item.context?.custom?.alt || "";
          const name       = safeDecode(nameRaw);
          const comment    = safeDecode(commentRaw);

          const videoUrl = buildVideoUrl(item.public_id, item.format);

          const card = document.createElement("article");
          card.className =
            "bg-white rounded-2xl shadow-sm border border-emerald-100 flex flex-col overflow-hidden";

          const thumbBtn = document.createElement("button");
          thumbBtn.type = "button";
          thumbBtn.className =
            "relative aspect-[3/4] w-full overflow-hidden bg-black/90 hover:opacity-90 transition";
          thumbBtn.addEventListener("click", () => {
            window.open(videoUrl, "_blank");
          });

          const video = document.createElement("video");
          video.src = videoUrl;
          video.className = "w-full h-full object-cover";
          video.muted = true;
          video.playsInline = true;
          video.loop = true;
          video.addEventListener("mouseenter", () => {
            video.play().catch(() => {});
          });
          video.addEventListener("mouseleave", () => {
            video.pause();
          });

          const playIcon = document.createElement("div");
          playIcon.className =
            "absolute inset-0 flex items-center justify-center";
          playIcon.innerHTML =
            '<div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-black/60 flex items-center justify-center text-white text-xl">â–¶</div>';

          thumbBtn.appendChild(video);
          thumbBtn.appendChild(playIcon);

          const body = document.createElement("div");
          body.className = "flex-1 px-3 pt-2 pb-3 flex flex-col";

          const nameEl = document.createElement("p");
          nameEl.className = "text-xs font-semibold text-emerald-900 truncate";
          nameEl.textContent = name || "åç„¡ã—ã®ã‚´ãƒ«ãƒ•ã‚¡ãƒ¼";

          const commentEl = document.createElement("p");
          commentEl.className =
            "mt-0.5 text-[11px] text-emerald-900/80 line-clamp-2 min-h-[2em]";
          commentEl.textContent = comment || "";

          const bottom = document.createElement("div");
          bottom.className = "mt-2 pt-2 border-t border-emerald-100";

          const openBtn = document.createElement("button");
          openBtn.type = "button";
          openBtn.className =
            "w-full inline-flex items-center justify-center gap-1 rounded-full bg-emerald-50 text-emerald-800 text-xs font-semibold py-1.5 hover:bg-emerald-100 transition";
          openBtn.innerHTML = "â†“ <span>é–‹ã„ã¦ä¿å­˜</span>";

          // â˜… ã“ã“ã‚’å¤‰æ›´ï¼šåˆ¥ã‚¿ãƒ–ã§å‹•ç”»ã‚’é–‹ã â†’ å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã€ãªã©
          openBtn.addEventListener("click", () => {
            window.open(videoUrl, "_blank");
          });

          bottom.appendChild(openBtn);
          body.appendChild(nameEl);
          body.appendChild(commentEl);
          body.appendChild(bottom);

          card.appendChild(thumbBtn);
          card.appendChild(body);

          videosGrid.appendChild(card);
        });
      } catch (err) {
        console.error(err);
        videosLoading.classList.add("hidden");
        videosError.classList.remove("hidden");
      }
    }

    // åˆæœŸãƒ­ãƒ¼ãƒ‰ï¼ˆå†™çœŸã‚¿ãƒ–ï¼‰
    loadPhotos();
  </script>
</body>
</html>
