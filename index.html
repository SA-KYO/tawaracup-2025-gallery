<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¤šå’Œæ¥½æ¯2025 ã‚®ãƒ£ãƒ©ãƒªãƒ¼</title>

  <!-- favicon 404å›é¿ç”¨ã®ãƒ€ãƒŸãƒ¼ -->
  <link rel="icon" href="data:,">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ãƒ•ã‚©ãƒ³ãƒˆ -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
    rel="stylesheet"
  />

  <style>
    body {
      font-family: "Noto Sans JP", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }
    .title-font {
      font-family: "Poppins", "Noto Sans JP", system-ui, sans-serif;
      letter-spacing: 0.08em;
    }
  </style>
</head>
<body class="bg-gradient-to-b from-purple-50 via-white to-purple-50 min-h-screen">
  <div class="max-w-5xl mx-auto px-4 py-6 md:py-10">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="mb-6 md:mb-8">
      <p class="text-xs md:text-sm text-purple-500 font-semibold tracking-[0.2em] uppercase mb-1">
        Tawara Cup 2025
      </p>
      <h1 class="title-font text-2xl md:text-3xl font-bold text-purple-800 mb-2">
        å¤šå’Œæ¥½æ¯2025 ã‚®ãƒ£ãƒ©ãƒªãƒ¼
      </h1>
      <p class="text-xs md:text-sm text-gray-600 leading-relaxed">
        ã‚³ãƒ³ãƒšå½“æ—¥ã«ã¿ã‚“ãªãŒã‚¢ãƒƒãƒ—ã—ã¦ãã‚ŒãŸå†™çœŸãƒ»å‹•ç”»ãŒã€è‡ªå‹•ã§ã“ã“ã«ä¸¦ã³ã¾ã™ã€‚
      </p>
    </header>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="mb-5">
      <a
        href="https://tawaracup-2025-photo.netlify.app/"
        class="inline-flex items-center gap-1 text-xs md:text-sm text-purple-700 border border-purple-200 rounded-full px-4 py-2 bg-white/70 hover:bg-purple-50 transition shadow-sm"
      >
        <span class="text-lg">â†</span>
        ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»é¢ã«æˆ»ã‚‹
      </a>
    </div>

    <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
    <div class="flex gap-3 mb-4">
      <button
        id="tab-photos"
        class="flex-1 inline-flex items-center justify-center gap-2 text-sm md:text-base font-semibold rounded-full py-2.5 md:py-3 border transition
               bg-purple-600 text-white border-purple-600 shadow-md shadow-purple-200"
      >
        <span class="text-lg">ğŸ“·</span>
        å†™çœŸ
      </button>
      <button
        id="tab-videos"
        class="flex-1 inline-flex items-center justify-center gap-2 text-sm md:text-base font-semibold rounded-full py-2.5 md:py-3 border transition
               bg-white text-purple-700 border-purple-200 hover:bg-purple-50"
      >
        <span class="text-lg">ğŸ¬</span>
        å‹•ç”»
      </button>
    </div>

    <!-- å†™çœŸã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section id="section-photos" class="space-y-3 md:space-y-4">
      <h2 class="flex items-center gap-2 text-base md:text-lg font-bold text-purple-800">
        <span class="text-xl">ğŸ“¸</span>
        å†™çœŸä¸€è¦§
      </h2>

      <!-- èª¬æ˜ -->
      <div class="bg-white rounded-2xl shadow-sm border border-purple-50 px-4 py-3 text-xs md:text-sm text-gray-700 leading-relaxed">
        <p>
          â€»ã€Œ<span class="font-semibold text-purple-700">â†“ é–‹ã„ã¦ä¿å­˜</span>ã€ã‚’ã‚¿ãƒƒãƒ— â†’ é–‹ã„ãŸç”»é¢ã‚’
          <span class="font-semibold">é•·æŠ¼ã—</span> â†’ ã€Œ<span class="font-semibold">å†™çœŸã«ä¿å­˜</span>ã€ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
        </p>
      </div>

      <!-- ã‚¨ãƒ©ãƒ¼ï¼ç©ºè¡¨ç¤º -->
      <p id="photos-error" class="hidden text-xs md:text-sm text-red-500">
        èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
      </p>
      <p id="photos-empty" class="hidden text-xs md:text-sm text-gray-500">
        ã¾ã å†™çœŸã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚³ãƒ³ãƒšå½“æ—¥ã«ãœã²ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„ï¼
      </p>

      <!-- ã‚°ãƒªãƒƒãƒ‰ -->
      <div
        id="photos-grid"
        class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4"
      ></div>
    </section>

    <!-- å‹•ç”»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section id="section-videos" class="space-y-3 md:space-y-4 hidden">
      <h2 class="flex items-center gap-2 text-base md:text-lg font-bold text-purple-800">
        <span class="text-xl">ğŸ¬</span>
        å‹•ç”»ä¸€è¦§
      </h2>

      <!-- èª¬æ˜ -->
      <div class="bg-white rounded-2xl shadow-sm border border-purple-50 px-4 py-3 text-xs md:text-sm text-gray-700 leading-relaxed">
        <p>
          â€»ã€Œ<span class="font-semibold text-purple-700">â†“ é–‹ã„ã¦ä¿å­˜</span>ã€ã‚’ã‚¿ãƒƒãƒ— â†’ é–‹ã„ãŸç”»é¢ã‚’
          <span class="font-semibold">é•·æŠ¼ã—</span> â†’ ã€Œ<span class="font-semibold">ãƒ“ãƒ‡ã‚ªã‚’ä¿å­˜</span>ã€ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
        </p>
      </div>

      <!-- ã‚¨ãƒ©ãƒ¼ï¼ç©ºè¡¨ç¤º -->
      <p id="videos-error" class="hidden text-xs md:text-sm text-red-500">
        èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
      </p>
      <p id="videos-empty" class="hidden text-xs md:text-sm text-gray-500">
        ã¾ã å‹•ç”»ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚³ãƒ³ãƒšå½“æ—¥ã«ãœã²ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„ï¼
      </p>

      <!-- ã‚°ãƒªãƒƒãƒ‰ -->
      <div
        id="videos-grid"
        class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4"
      ></div>
    </section>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="mt-8 md:mt-10 text-center text-[11px] md:text-xs text-gray-400">
      Â© 2025 å¤šå’Œæ¥½æ¯ã‚³ãƒ³ãƒšå®Ÿè¡Œå§”å“¡ä¼š
    </footer>
  </div>

  <script>
    // ===== Cloudinary è¨­å®š =====
    const CLOUD_NAME = "dpef3dzrk";
    const TAG_PHOTOS = "tawarahai2025";
    const TAG_VIDEOS = "tawarahai2025";

    const PHOTO_LIST_URL = `https://res.cloudinary.com/${CLOUD_NAME}/image/list/${TAG_PHOTOS}.json`;
    const VIDEO_LIST_URL = `https://res.cloudinary.com/${CLOUD_NAME}/video/list/${TAG_VIDEOS}.json`;

    // ===== DOM è¦ç´  =====
    const photosGrid = document.getElementById("photos-grid");
    const videosGrid = document.getElementById("videos-grid");

    const photosError = document.getElementById("photos-error");
    const photosEmpty = document.getElementById("photos-empty");
    const videosError = document.getElementById("videos-error");
    const videosEmpty = document.getElementById("videos-empty");

    const tabPhotos = document.getElementById("tab-photos");
    const tabVideos = document.getElementById("tab-videos");
    const sectionPhotos = document.getElementById("section-photos");
    const sectionVideos = document.getElementById("section-videos");

    // ===== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ =====
    function activateTab(tab) {
      const isPhotos = tab === "photos";

      if (isPhotos) {
        sectionPhotos.classList.remove("hidden");
        sectionVideos.classList.add("hidden");

        tabPhotos.classList.add(
          "bg-purple-600",
          "text-white",
          "border-purple-600",
          "shadow-md",
          "shadow-purple-200"
        );
        tabPhotos.classList.remove("bg-white", "text-purple-700");

        tabVideos.classList.remove(
          "bg-purple-600",
          "text-white",
          "border-purple-600",
          "shadow-md",
          "shadow-purple-200"
        );
        tabVideos.classList.add("bg-white", "text-purple-700", "border-purple-200");
      } else {
        sectionPhotos.classList.add("hidden");
        sectionVideos.classList.remove("hidden");

        tabVideos.classList.add(
          "bg-purple-600",
          "text-white",
          "border-purple-600",
          "shadow-md",
          "shadow-purple-200"
        );
        tabVideos.classList.remove("bg-white", "text-purple-700");

        tabPhotos.classList.remove(
          "bg-purple-600",
          "text-white",
          "border-purple-600",
          "shadow-md",
          "shadow-purple-200"
        );
        tabPhotos.classList.add("bg-white", "text-purple-700", "border-purple-200");
      }
    }

    tabPhotos.addEventListener("click", () => activateTab("photos"));
    tabVideos.addEventListener("click", () => activateTab("videos"));

    // ===== ç”»åƒèª­ã¿è¾¼ã¿ =====
    async function loadPhotos() {
      photosGrid.innerHTML = "";
      photosError.classList.add("hidden");
      photosEmpty.classList.add("hidden");

      try {
        const res = await fetch(PHOTO_LIST_URL, { cache: "no-store" });
        if (!res.ok) throw new Error("status " + res.status);

        const data = await res.json();
        const resources = (data && data.resources) || [];

        if (!resources.length) {
          photosEmpty.classList.remove("hidden");
          return;
        }

        // æ–°ã—ã„é †ã«
        resources.sort((a, b) => (a.created_at < b.created_at ? 1 : -1));

        resources.forEach((item) => {
          const originalUrl = item.secure_url;
          const thumbUrl = `https://res.cloudinary.com/${CLOUD_NAME}/image/upload/c_fill,w_800,h_800,q_auto,f_auto/${item.public_id}.${item.format}`;

          const card = document.createElement("div");
          card.className =
            "bg-white rounded-2xl shadow-sm border border-purple-50 overflow-hidden flex flex-col";

          const img = document.createElement("img");
          img.src = thumbUrl;
          img.alt = item.public_id || "photo";
          img.loading = "lazy";
          img.className = "w-full aspect-[4/5] object-cover";

          img.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          const bottom = document.createElement("div");
          bottom.className =
            "px-3 py-2 border-t border-purple-50 flex flex-col items-center";

          const btn = document.createElement("button");
          btn.type = "button";
          btn.textContent = "â†“ é–‹ã„ã¦ä¿å­˜";
          btn.className =
            "mt-0 inline-flex items-center justify-center text-xs md:text-sm font-semibold text-purple-700 px-3 py-1.5 rounded-full bg-purple-50 hover:bg-purple-100 transition";

          btn.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          const note = document.createElement("p");
          note.className = "mt-1 text-[10px] text-gray-400 text-center";
          note.textContent = "é–‹ã„ãŸç”»é¢ã‚’é•·æŠ¼ã— â†’ ã€å†™çœŸã«ä¿å­˜ã€";

          bottom.appendChild(btn);
          bottom.appendChild(note);

          card.appendChild(img);
          card.appendChild(bottom);

          photosGrid.appendChild(card);
        });
      } catch (e) {
        console.error("photos load error", e);
        photosError.classList.remove("hidden");
      }
    }

    // ===== å‹•ç”»èª­ã¿è¾¼ã¿ =====
    async function loadVideos() {
      videosGrid.innerHTML = "";
      videosError.classList.add("hidden");
      videosEmpty.classList.add("hidden");

      try {
        const res = await fetch(VIDEO_LIST_URL, { cache: "no-store" });
        if (!res.ok) throw new Error("status " + res.status);

        const data = await res.json();
        const resources = (data && data.resources) || [];

        if (!resources.length) {
          videosEmpty.classList.remove("hidden");
          return;
        }

        resources.sort((a, b) => (a.created_at < b.created_at ? 1 : -1));

        resources.forEach((item) => {
          const originalUrl = item.secure_url;

          // ãƒã‚¹ã‚¿ãƒ¼ç”¨ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆ1ç§’åœ°ç‚¹ã®é™æ­¢ç”»ï¼‰
          const posterUrl = `https://res.cloudinary.com/${CLOUD_NAME}/video/upload/so_1/${item.public_id}.jpg`;

          const card = document.createElement("div");
          card.className =
            "bg-white rounded-2xl shadow-sm border border-purple-50 overflow-hidden flex flex-col";

          const thumbWrapper = document.createElement("button");
          thumbWrapper.type = "button";
          thumbWrapper.className = "w-full aspect-video bg-black/5";
          thumbWrapper.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          const thumbImg = document.createElement("img");
          thumbImg.src = posterUrl;
          thumbImg.alt = item.public_id || "video";
          thumbImg.loading = "lazy";
          thumbImg.className = "w-full h-full object-cover";

          thumbWrapper.appendChild(thumbImg);

          const bottom = document.createElement("div");
          bottom.className =
            "px-3 py-2 border-t border-purple-50 flex flex-col items-center";

          const btn = document.createElement("button");
          btn.type = "button";
          btn.textContent = "â†“ é–‹ã„ã¦ä¿å­˜";
          btn.className =
            "mt-0 inline-flex items-center justify-center text-xs md:text-sm font-semibold text-purple-700 px-3 py-1.5 rounded-full bg-purple-50 hover:bg-purple-100 transition";

          btn.addEventListener("click", () => {
            window.open(originalUrl, "_blank");
          });

          const note = document.createElement("p");
          note.className = "mt-1 text-[10px] text-gray-400 text-center";
          note.textContent = "é–‹ã„ãŸç”»é¢ã‚’é•·æŠ¼ã— â†’ ã€ãƒ“ãƒ‡ã‚ªã‚’ä¿å­˜ã€";

          bottom.appendChild(btn);
          bottom.appendChild(note);

          card.appendChild(thumbWrapper);
          card.appendChild(bottom);

          videosGrid.appendChild(card);
        });
      } catch (e) {
        console.error("videos load error", e);
        videosError.classList.remove("hidden");
      }
    }

    // åˆæœŸãƒ­ãƒ¼ãƒ‰ï¼šå†™çœŸã‚¿ãƒ– & å†™çœŸãƒ»å‹•ç”»ãƒ‡ãƒ¼ã‚¿
    activateTab("photos");
    loadPhotos();
    loadVideos(); // å‹•ç”»ã‚¿ãƒ–ã‚’é–‹ã„ãŸæ™‚ã«ã™ãè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†å…ˆèª­ã¿
  </script>
</body>
</html>
